仓储模式以及工作单元模式

&emsp;The repository mediates between the data source layer and the business layers of the application. It queries the data source for the data, maps the data from the data source to a business entity, and persists changes in the business entity to the data source. A repository separates the business logic from the interactions with the underlying data source or Web service. 

&emsp;The client submits new or changed entities to the repository for persistence. In more complex situations, the client business logic can use the Unit of Work pattern. This pattern demonstrates how to encapsulate several related operations that should be consistent with each other or that have related dependencies. The encapsulated items are sent to the repository for update or delete actions.. For more information, see [Unit of Work](http://martinfowler.com/eaaCatalog/unitOfWork.html) on [Martin Fowler](http://www.martinfowler.com/)'s Web site.

参考：

[Repository](https://msdn.microsoft.com/en-us/library/ff649690.aspx)



`dotnet ef migrations add InitialCreate`

`dotnet ef database update`



工作单元

&emsp;工作单元解决的基本问题是记录操作过的各种对象，以便知道为了使内存中的数据与数据库同步需要考虑哪些对象。

&emsp;把每个所改变的对象加上“脏”标志的做法要比把对象保存在变量中好。在事务处理完后，需要找出所有加了“脏”标记的对象并把它们写入到数据库中。

&emsp;引发你去处理数据库的明显原因是变化：创建新对象和更新或删除已经存在的对象。工作单元就是 一个记录这些变化的**对象**。只要开始做一些可能会对数据库有影响的操作，就创建一个工作单元去记录这些变化。每当创建、改变或者删除一个对象时，就通知此工作单元。